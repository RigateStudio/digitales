<!-- TEMPLATE DE FLEX -->

<div class="container">
    <div class="row align-items-center">
      <!-- COLONNE DE GAUCHE -->
      <div class="col-12 col-md mb-5">
<br>

        <!-- Link -->
        <a class="font-weight-bold font-size-sm text-decoration-none mb-5 mt-5" href="https://go-os-develop.herokuapp.com/fr/projets?page=2">
          <i class="fas fa-arrow-left mr-3" aria-hidden="true"></i>
          Page précédente
</a>
        <!-- Heading -->
        <h1 class="display-4 my-2">

          Feedward
        </h1>

      </div>
      <div class="col-auto">

        <!-- Buttons -->
      </div>
    </div> <!-- / .row -->
    <div class="row">
      <div class="col-12">

        <!-- Divider -->
        <hr class="my-6 my-md-8 border-gray-300">

      </div>
    </div> <!-- / .row -->
    <div class="row">
      <div class="col-12 col-md-4">

        <!-- Card -->
        <div class="card shadow-light-lg mb-5">
          <div class="card-body">

            <!-- Heading -->
            <h4>
              Porteur du projet
            </h4>

            <!-- different Heading -->
            <h6 class="font-weight-bold text-uppercase text-gray-700 my-2">
              Antoine Bernard
            </h6>

            <!-- Heading -->
            <a class="font-weight-bold font-size-sm text-decoration-none" href="/fr/utilisateur/1">
              Antoine
                <i class="fas fa-arrow-right ml-3" aria-hidden="true"></i>
            </a>          
        </div>
    </div>

</div>
      
      <!-- COLLONNE DE DROITE -->
      <div class="col-12 col-md-8 bg-dark">
       <!-- COLLONNE DE DROITE -->
      </div>
      
      <!-- EN BAS DES COLLONNES-->
      <div class="col-12 col-md-8 bg-dark">
       <!-- EN BAS DES COLLONNES -->
      <div class="col-auto">
        <a class="btn btn-primary fund_btn" href="/fr/projets/feedward/paiement">Financer</a>
      </div>
    </div> <!-- / .row -->
  </div>

<!-- NOTRE CODE -->

<div id="profile-block">
  <section class="fdb-block">
      <div class="row">
        <!--COLLONE DE GAUCHE-->
        <div class="col-md-6 mb-4 mb-md-0">
        <div id="avatar">
                <%if @creatrix.avatar.attached?%>
                    <%= image_tag @creatrix.avatar, alt: 'avatar', class: "img-fluid", id: "avatar-image" %>
                <%else%>
                    no pics
                <%end%>
                <h5><%= @creatrix.itself.email %></h5>
                <p class="lead"></p>    
            </div>
            
            <% if @creatrix == current_creatrix %>
                <div id="creatrix-details">
                    <h4> My details: </h4>
                    <p><strong> Email address </strong>: <%= @creatrix.email %></p>
                    <%= link_to "e d i t", edit_creatrix_registration_path, class: 'btn btn-secondary' %>            
                </div>  
            <% end %> 
        </div>
        
<!--COLLONE DE DROITE-->

        <div class="col-lg-7 ml-md-auto">
          <div id="in-page-links">
              <div><a href="#microservices"> m i c r o s e r v i c e . s </a> </div>
              <div><a href="#fundraising-block"> n o d e . s </a> </div>
              <!--<div><a href="#my-creations-block"> My creations </a> </div>-->
              <div><a href="#my-participations-block"> d o n a t i o n . s </a> </div>
          </div>

          <div id="microservices">
            <div class='container'>
              <h4 class="text-center">m i c r o s e r v i c e . s</h4>
              <%= render "microservices/new"%>
              <h4 class="text-center">r e q u e s t . s</h4>
              <div class='d-flex flex-wrap'>
                <% @microservice_requests.each do |microservice_request| %>
                  <div class='card m-2' style='width: 15em'>
                    <div class='card-header'>
                      <%= render "microservices/media_display", microservice: microservice_request.microservice %>
                    </div>
                    <div class='card-body'>
                      <ul>
                        <li><%=microservice_request.achievement.achievement_category.name %></li>
                        <li><%=microservice_request.microservice.microservice_category.name %></li>
                        <li>price : <%=(microservice_request.microservice.price.to_f / 100).ceil(2)  %> $</li>
                      </ul>
                    </div>
                    <% if microservice_request.fundraisers.last && microservice_request.fundraisers.last.funded? %>
                      <div class='card-footer'>
                        <%= form_with model: microservice_request, id: "form_request#{@y}", url: microservice_request_path(microservice_request.id),method: "patch" do |f| %>
                          <%= hidden_field(:microservice_request, :media, :value => true) %>
                          <% case microservice_request.microservice.microservice_category.media_type%>
                          <% when "image"%>
                            <%= f.label :art_work, "image" %> :
                            <%= f.fields_for :art_work  do |p| %>
                                <%= p.file_field :art_work , :multiple => true, name: :art_work %>
                            <% end %>
                          <% when "video"%>
                            <%= f.label :youtube,"youtube link" %> :
                            <%= f.text_field :youtube, style: "width: 20em"%>        
                          <% when "sound"%>
                            <%= f.label :soundcloude,"soundcloude embed share code" %> :
                            <%= f.text_field :soundcloude, style: "width: 20em"%>   
                          <% when "text"%>
                            <%= f.hidden_field :quill, id: "post-quill#{@y}", required: true %>
                            <div id="editor-container" hidden="true"></div>
                            <div id="editor<%=@y%>"></div>
                            <script>
                              var form_request = document.querySelector('#form_request<%=@y%>');
                              var quill = new Quill('#editor<%=@y%>', {
                                theme: 'snow'
                              });
                              form_request.onsubmit = function() {
                                document.querySelector('#post-quill<%=@y%>').value = document.querySelector('#form_request<%=@y%>').children[7].children[0].innerHTML;
                              };
                            </script>  
                          <%end%>
                          <%= submit_tag("Upload youre work") %>
                        <%@y += 1%>
                        <% end %>
                      </div>
                    <% elsif microservice_request.accepted? %>
                      <div class='card-footer'>
                        <p>Founding in progress</p>
                      </div>
                    <% else %>
                      <%= form_with(url: microservice_request_path(microservice_request.id), method: "patch")  do |f| %>
                        <%= hidden_field(:microservice_request, :accepted, :value => true) %>
                        <%= submit_tag("Accept request", class: 'card-footer btn btn-primary' ) %>
                      <% end %>
                    <%end%>
                  </div>
                <%end%>
              </div>
            </div>  
          </div>

          <div id="fundraising-block" class="d-flex flex-column justify-content-center">
                  <div>
                      <h4 class="text-center">n o d e . s</h4>
                          <div class="p-5" id="box-drop-shadow">
                          <h2></h2>
                          <br>
                          <% @creatrix.nodes.each do |node| %>
                              <h3><%= link_to node.title, node_path(node.id)  %></h3>
                              <h6><%= node.achievements.count.to_s %> achievements out of 21</h6>
                              <p><%= node.content %></p>
                              <p></p>
                          <% end %>
                          </div>
                  </div>
          </div>


            <div id="my-participations-block" >
                    <div>
                        <h4 class="text-center">d o n a t i o n . s</h4>
                        <div class="row text-left mt-5 justify-content-between">
                            <div class="col-4">
                                <div class="fdb-box fdb-touch p-5" id="box-drop-shadow">
                                <h2>Petite pasteque en fleurs</h2>
                                <br>
                                <h5>Node</h5>
                                <p>Far far away, behind the word...</p>
                                <br>
                                <div><p><a class="btn btn-secondary mt-2" style="width:100%" href="https://www.google.com">Go to node</a></div>
                                </div>
                            </div>

                            <div class="col-4">
                                <div class="fdb-box fdb-touch p-5" id="box-drop-shadow">
                                <h2>Petite pasteque en fleurs</h2>
                                <br>
                                <h5>Node</h5>
                                <p>Far far away, behind the word...</p>
                                <br>
                                <div><p><a class="btn btn-secondary mt-2" style="width:100%" href="https://www.google.com">Go to node</a></div>
                                </div>
                            </div>


                            <div class="col-4">
                                <div class="fdb-box fdb-touch p-5" id="box-drop-shadow">
                                <h2>Petite pasteque en fleurs</h2>
                                <br>
                                <h5>Node</h5>
                                <p>Far far away, behind the word...</p>
                                <br>
                                <div><p><a class="btn btn-secondary mt-2" style="width:100%" href="https://www.google.com">Go to node</a></div>
                                </div>
                            </div>

                        
                        </div>
                    </div>
            </div>


        </div>
      </div>
  </section>
</div>
